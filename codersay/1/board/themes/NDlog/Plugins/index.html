<!doctype html>
<html>
	<head>
		<title>{:C('SITE_TITLE')}</title>
		<meta charset="utf-8" />
		<include file="Public:commonjs" />
		<link rel="stylesheet" type="text/css" href="../Public/style/layout.css" />
		<script type="text/javascript" src="__JS__/jQuery/jquery.js"></script>
		<script type="text/javascript" src="__JS__/jQuery/plugin/cookie.js"></script>
		<script type="text/javascript" src="__JS__/NDlogpublic.js"></script>
		<script type="text/javascript" src="../Public/js/common.js"></script>
		<script type="text/javascript">
			jQuery(document).ready(function($){
				NDlog._setTableStyle( 'input[name="all"]', 'input[name="ids[]"]', '.rows_style' );
				$('.esort').dblclick(function(){
					var id = $(this).attr('rel');
					var ovalue = $(this).text();
					$(this).html('<input type="text" name="sort_one" id="edit_'+id+'" class="t_input" style="width:24px;" value="'+ovalue+'" />');
					$('#edit_'+id).focus().live('blur',function(){
						var value = $(this).val();
						if ( !/^\d+$/.test(value) ){
							alert('排序必须为正整数！');
							return false;
						}else{
							$(this).parent().html(value);
							if ( ovalue != value ){
								$.post('{:U("updateOneSort")}',{id:id,sort:value});
							}
						}
					});
				});
			});
		</script>
		<style type="text/css" media="all">
			.page_tit	{ font-weight: bold; padding-bottom: 10px; }
			.so_main	{ padding-bottom: 20px; }
		</style>
	</head>
	<body>
		<div id="wrap">
			<include file="Public:header" />
			<div id="container">
				<div id="sidebar_switch"></div>
				<div id="content">
					<div id="c_warp">

						<php>foreach($list as $type=>$value) {</php>
						<div class="so_main">
						    <div class="page_tit">{$value['name']}</div>
						    <div class="Toolbar_inbox"></div>
						    <div class="list">
						        <table id="plugInTable" width="100%" cellpadding="0" cellspacing="0" border="0" class="table_list">
							        <tr>
							        	<th align="center" width="40">排序</th>
							            <th class="line_l">插件名称</th>
							            <th class="line_l">插件作者</th>    
							            <th class="line_l">插件版本</th>
							            <th class="line_l">插件说明</th>
							            <th class="line_l">操作</th>
							        </tr>
						        <php>if(empty($value['data'])) {</php>

						        <php>}</php>
						        <volist id="vo" name="value.data">
						        <tr overstyle='on' id="{$vo['name']}" class="rows_style"<?php if( ( $i % 2 ) == 0 ){ ?> bgcolor="#f9f9f9"<?php }else{ ?> bgcolor="#ffffff"<?php } ?>>
						        	<td align="center" rel="{$vo.id}" class="esort">{$vo.sort}</td>
						            <td><?php if ( !isset( $vo['pluginName'] ) ) { echo $vo['title']; }else{ echo $vo['pluginName']; } ?></td>
						            <td align="center">
						            	<?php if ( !isset( $vo['site'] ) ){
							            		$url = $vo['uri'];
							            	}else{
							            		$url = $vo['site'];
							            	} ?>
							            	<php>if($url){</php><a href="{$url}">{$vo['author']}</a><php>}else{</php>{$vo['author']}<?php } ?>
						            </td>
						            <td align="center">{$vo['version']}</td>
						            <td><?php if ( !isset( $vo['info'] ) ) { echo $vo['remark']; }else{ echo $vo['info']; } ?></td>
						            <td align="center">
						                <php>if($type == "valid"){</php>
						             	<php>
						    	        $uninstall_href = U('plugins/stopAddon',array('addonId'=>$vo['id']));
						    	        $uninstall_alert_1 = '确定停用该插件?';
						    	        </php>
						                <a href="javascript:void(0);" onclick="if(confirm('{$uninstall_alert_1}')) location.href='{$uninstall_href}';return false;">停用</a>
						                <php>}else{</php>
						                <php>
						                $install_href = U('plugins/startAddon',array('name'=>$vo['name']));
						                if($vo['sqlfile']){
						                	$install_alert_1 = '初次启用该插件时将会进行sql操作，且无法恢复，强烈建议您备份数据库后再启用，确定继续?';
						                }else{
						                	$install_alert_1 = '确定启用该插件？';
						                }
						                </php>
						                <a href="javascript:void(0);" onclick="if(confirm('{$install_alert_1}')) location.href='{$install_href}';return false;">启用</a>
						                <php>}</php>
						                <php>if($vo['admin'] && $type == "valid"){</php>
						                <php>
						                $href = U('plugins/admin',array('pluginid'=>$vo['id'],'node'=>$_GET['node']));
						                </php>
						                <span class="c_line">|</span>
						                <a href="javascript:void(0);" onclick="location.href='{$href}';return false;">管理</a>
						                <php>}</php>
						            </td>
						        </tr>
						        </volist>
						    </table>
						    </div>
						    <div class="Toolbar_inbox"></div>
						</div>
						<php>}</php>
					</div>
				</div>
				<include file="Public:sidebar" />
			</div>
		</div>
	</body>
</html>