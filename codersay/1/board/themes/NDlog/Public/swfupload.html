<link href="__JS__/swfupload/swfupload.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="__JS__/swfupload/swfupload.js"></script>
		<script type="text/javascript" src="__JS__/swfupload/swfupload.swfobject.js"></script>
		<script type="text/javascript" src="__JS__/swfupload/swfupload.queue.js"></script>
		<script type="text/javascript" src="__JS__/swfupload/fileprogress.js"></script>
		<script type="text/javascript" src="__JS__/swfupload/handlers.js"></script>
		
		<script type="text/javascript">
			
			//swf upload
			var swfu;
			
			SWFUpload.onload = function () {
				var settings = {
					flash_url : "__JS__/swfupload/swfupload.swf",
					upload_url: "{:U('album/upload')}",
					post_params: {"PHPSESSID" : "<?php echo $_COOKIE['PHPSESSID']; ?>", "uid" : "<?php echo $_SESSION['AUTH']['id']; ?>"},
					use_query_string : false, //支持传输自定义参数
					file_size_limit : "100 MB",
					file_types : "*.jpg;*.jpeg;*.gif;*.png",
					file_types_description: "图片文件",
					file_upload_limit : 100,
					file_queue_limit : 0,
					custom_settings : {
						progressTarget : "fsUploadProgress",
						cancelButtonId : "btnCancel"
					},
					debug: false,
			
					// Button Settings
					button_placeholder_id : "spanButtonPlaceholder",
					button_width: 80,
					button_height: 30,
					button_window_mode: SWFUpload.WINDOW_MODE.TRANSPARENT,
					button_cursor: SWFUpload.CURSOR.HAND,
			
					// The event handler functions are defined in handlers.js
					swfupload_loaded_handler : swfUploadLoaded,
					file_queued_handler : fileQueued,
					file_queue_error_handler : fileQueueError,
					file_dialog_complete_handler : fileDialogComplete,
					upload_start_handler : uploadStart,
					upload_progress_handler : uploadProgress,
					upload_error_handler : uploadError,
					upload_success_handler : uploadSuccess,
					upload_complete_handler : uploadComplete,
					queue_complete_handler : queueComplete,	// Queue plugin event
					
					// SWFObject settings
					minimum_flash_version : "9.0.28",
					swfupload_pre_load_handler : swfUploadPreLoad,
					swfupload_load_failed_handler : swfUploadLoadFailed
				};
			
				swfu = new SWFUpload(settings);
				
				//alert(settings.upload_url);
			}
			
			// 删除单张已上传图片
			function deluppic(key){
				if(confirm('确定删除?')){
					$.ajax({
						url: '{:U("album/delpic")}',
						type : 'GET',
						data : 'file='+key,
						cache: false,
						success: function(res){
							picslist();
						}
					});
				}
			}

			// 删除全部已经上传图片
			function delalluppic(){
				if(confirm('确定删除?')){
					$.ajax({
						url: '{:U("album/delalluppic")}',
						cache: false,
						success: function(res){
							picslist();
						}
					});
				}
			}
			
			// 加载已上传图片
			function picslist(){
				$.ajax({
					url: '{:U("album/itemlist")}',
					cache: false,
					success: function(res){
						$('#pics_upload_list').html(res);
					}
				});
			}
		</script>